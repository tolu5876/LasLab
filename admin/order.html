<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Manage Orders</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <style>
      body {
        background: #f4f6f9;
      }
      .sidebar {
        min-height: 100vh;
        background: #111;
        color: #fff;
      }
      .sidebar a {
        color: #bbb;
        display: block;
        padding: 12px 20px;
        text-decoration: none;
      }
      .sidebar a:hover,
      .sidebar a.active {
        background: #ff3b3b;
        color: #fff;
      }
    </style>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row">
        <!-- SIDEBAR -->
        <div class="col-md-3 col-lg-2 sidebar p-0">
          <h4 class="text-center py-4 border-bottom">Admin Panel</h4>
          <a href="dashboard.html"
            ><i class="bi bi-speedometer2 me-2"></i> Dashboard</a
          >
          <a href="products.html"
            ><i class="bi bi-box-seam me-2"></i> Products</a
          >
          <a href="orders.html" class="active"
            ><i class="bi bi-bag-check me-2"></i> Orders</a
          >
          <a href="../index.html"
            ><i class="bi bi-globe me-2"></i> View Website</a
          >
        </div>

        <!-- MAIN -->
        <div class="col-md-9 col-lg-10 p-4">
          <h2 class="mb-4">Orders</h2>

          <!-- ADD ORDER FORM -->
          <div class="card mb-4">
            <div class="card-body">
              <div class="row g-3">
                <div class="col-md-3">
                  <input
                    type="text"
                    id="customer"
                    class="form-control"
                    placeholder="Customer Name"
                  />
                </div>
                <div class="col-md-3">
                  <input
                    type="text"
                    id="product"
                    class="form-control"
                    placeholder="Product Name"
                  />
                </div>
                <div class="col-md-2">
                  <input
                    type="number"
                    id="quantity"
                    class="form-control"
                    placeholder="Quantity"
                  />
                </div>
                <div class="col-md-2">
                  <input
                    type="number"
                    id="total"
                    class="form-control"
                    placeholder="Total Price"
                  />
                </div>
                <div class="col-md-2 d-grid">
                  <button class="btn btn-danger" onclick="addOrder()">
                    Add
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- ORDERS TABLE -->
          <div class="table-responsive">
            <table class="table table-striped align-middle">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Customer Name</th>
                  <th>Product</th>
                  <th>Quantity</th>
                  <th>Total</th>
                  <th>Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="orderTable"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Load orders from localStorage
      let orders = JSON.parse(localStorage.getItem("orders")) || [];

      function renderOrders() {
        const table = document.getElementById("orderTable");
        table.innerHTML = "";

        if (orders.length === 0) {
          table.innerHTML = `<tr><td colspan="7" class="text-center">No orders yet.</td></tr>`;
          return;
        }

        orders.forEach((order, index) => {
          table.innerHTML += `
        <tr>
          <td>${index + 1}</td>
          <td>${order.customer}</td>
          <td>${order.product}</td>
          <td>${order.quantity}</td>
          <td>â‚¦${parseFloat(order.total).toFixed(2)}</td>
          <td>
            <span class="badge ${
              order.status === "Completed" ? "bg-success" : "bg-warning"
            }">
              ${order.status}
            </span>
          </td>
          <td>
            ${
              order.status === "Pending"
                ? `<button class="btn btn-sm btn-success me-1" onclick="completeOrder(${index})">
                <i class="bi bi-check-lg"></i>
               </button>`
                : ""
            }
            <button class="btn btn-sm btn-danger" onclick="deleteOrder(${index})">
              <i class="bi bi-trash"></i>
            </button>
          </td>
        </tr>
      `;
        });

        localStorage.setItem("orders", JSON.stringify(orders));
      }

      function addOrder() {
        const customer = document.getElementById("customer").value.trim();
        const product = document.getElementById("product").value.trim();
        const quantity = parseInt(
          document.getElementById("quantity").value.trim()
        );
        const total = parseFloat(document.getElementById("total").value.trim());

        if (
          !customer ||
          !product ||
          isNaN(quantity) ||
          quantity <= 0 ||
          isNaN(total) ||
          total <= 0
        ) {
          alert("Please fill all fields with valid values");
          return;
        }

        orders.push({
          customer,
          product,
          quantity,
          total,
          status: "Pending",
        });

        renderOrders();

        // Clear form
        document.getElementById("customer").value = "";
        document.getElementById("product").value = "";
        document.getElementById("quantity").value = "";
        document.getElementById("total").value = "";
      }

      function completeOrder(index) {
        orders[index].status = "Completed";
        renderOrders();
      }

      function deleteOrder(index) {
        if (confirm("Are you sure you want to delete this order?")) {
          orders.splice(index, 1);
          renderOrders();
        }
      }

      renderOrders();
    </script>
  </body>
</html>
